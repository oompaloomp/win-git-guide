<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Иллюстрированое руководство по Git на Windows</title>
        <link rel="stylesheet" href="style.css" />
    </head>
    <body>
        <h1>Иллюстрированое руководство по Git на Windows</h1>

        <h2 id="about">О документе</h2>

        <p>Этот документ предназначен для того что бы показать что
        использование git на Windows не сложный процесс.В этом руководстве,
        я создам хранилище (repository), сделаю несколько фиксаций (commits),
        создам ветвь (branch), солью (merge) ветки, осуществлю поиск в истории
        фиксаций, опубликую (push) изменения на удалённом сервере, and pull
        from a remote server. Большинство из этого будет выполнено с помощью
        GUI программ.</p>

        <p>Несмотря на то что данное руководство предназначено для Windows, git
        GUI работает так же на всех платформах. Поэтому пользователи git на
        других платформат могут найти представленую здесь информацию так-же
        полезной.</p>

        <p>Если у вас есть какие-либо коментарии об этом руководстве, не
        стесняйтесь <a href="mailto:nathanj@insightbb.com">обращатся к
        автору</a> или <a href="mailto:kron82@gmail.com">переводчику</a>.</p>

        <h2 id="putty">Загрузка PuTTY</h2>

        <p>Несмотря на то что вы модете использовать SSH программу поставляемую
        с git, я предпочитаю испольвать PuTTY Agent что бы хранить мои SSH
        ключи. Если вы до сих пор не имеет из, скачайте их
        <span class="tt">putty.exe</span>, <span class="tt">plink.exe</span>,
        <span class="tt">pageant.exe</span>, и <span class="tt">puttygen.exe</span>
        с <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">
        сайта PuTTY</a>.</p>

        <p>Позже в этом руководстве, вы используем эти программы для безопастной
        публикации наших изменений на удалённом сервере.</p>

        <h2 id="installing">Установка git</h2>

        <p>Для начала, скачайте <a
            href="http://code.google.com/p/msysgit/downloads/list">msysgit</a>.
        Тут вы скачаете единый исполняемый файл, который установит git систему
        целиком. При прохождении шагов установочной программы, вы можете захотеть
        отметить опцию интеграции с Windows Explorer, когда вы совершаете правый
        щелчёк мыши на папке.</p>

        <p><img src="images/install.png" /></p>

        <p>Так как мы будем использовать PuTTY как наш SSH клиент, выберите
        <em>Use PLink</em> и заполните путь до скачанной <span class="tt">
        plink.exe</span> программы.</p>

        <p><img src="images/26.png" /></p>

        <p>Продолжите нажатием <em>Next</em> пока установка не завершится.</p>

        <h2 id="creating">Создание хранилища</h2>

        <p><img src="images/01.png" /></p>

        <p>Что бы создать хранилище, сначала создайте папку в которой ваш проект
        будет жить. Далее, правый щелчёк мышки на этой папке и выберете <em>Git
        GUI Here</em>. Так-как в папке пока что не содержится git хранилища вам
        будет показан диалог создания.</p>

        <p><img src="images/02.png" /></p>

        <p>Выбор <em>Create New Repository</em> приводит нас к следующему
        диалогу.</p>

        <p><img src="images/03.png" /></p>

        <p>Заполните путь к вашей новой директории и щёлкните <em>Create</em>.
        Далее вы увидите главный интерфейс git gui, который в дальнейшем будет
        показыватся когда вы будете делать правый щёлчёк на вашей папке и
        выбирать <em>Git GUI Here</em>.</p>

        <p><img src="images/04.png" /></p>

        <p>Теперь когда хранилище создано, вам надо сообщить git-у кто вы
        такой, что бы сообщении фиксации (commit message) был отмечен
        правильный автор. Что бы сделать это, выберете <i>Edit &rarr;
        Options</i>.</p>

        <p><img src="images/25.png" /></p>

        <p>В диалоге опций расплоложены 2 варианта на выбор. С левой стороны
        диалога опции которые влияют только на это хранилище, в товремя как
        правая сторона содержит глобальные опции применяемые ко всем хранилищам.
        Значения по умолчанию приемлимы, так что заполните только имя
        пользователя и email, пока что. Если у вас есть любимый шрифт, вы
        можете выставить его сейчас, так же.</p>

        <h2 id="committing">Фиксация изменений (commiting)</h2>

        <p>Теперь, когда хранилище было создато, пора создать что нибудь
        для фиксации. Для этого примера я создал файл <span class="tt">main.c
        </span> со следующим содержимым:

        <pre>
#include &lt;stdio.h&gt;

int main(int argc, char **argv)
{
    printf("Hello world!\n");
    return 0;
}
</pre>

        <p>Щелчёк на кнопку <em>Rescan</em> в git gui заставит его искать
        новые, измененные и удалённые файлы в директории. На следующем
        скриншоте git gui нашёл новый файл (удивительно, я знаю).</p>

        <p><img src="images/09.png" /></p>

        <p>Что бы добавить этот файл в фиксацию, щёлкните на иконке слева от
        имени файла. Файл будет перемещён с <em>Unstaged Changes</em> панели на
        <em>Staged Changes</em> панель. Теперь мы можем добавить сообщение
        фиксации (commit message) и зафиксировать изменения <em>Commit</em>
        кнопкой.</p>

        <p><img src="images/10.png" /></p>

        <p>Говорить 'hello world' это конечно хорошо, но я хочу что бы моя
        программа была более персонализирована. Давайте скажем 'hello'
        пользователю. Вот как будет выглядеть код:</p>

        <pre>
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

int main(int argc, char **argv)
{
    char name[255];

    printf("Enter your name: ");
    fgets(name, 255, stdin);
    printf("length = %d\n", strlen(name)); /* debug line */
    name[strlen(name)-1] = '\0'; /* remove the newline at the end */

    printf("Hello %s!\n", name);
    return 0;
}
</pre>

        <p>У меня были пробелемы с тем что новая линия печаталась после имени
        пользователя, поэтому я добавил отладочную линию кода, что бы помочь
        себе найти причину. Я бы хотел зафиксировать изменение без этой
        отладочной линии, но я хочу сохранить эту линию в моей рабочей копии
        что бы продолжить отладку. С git gui это не проблема. Сначала щёлкните
        <em>Rescan</em> для поиска изменений. Далее щёлкните на иконке слева от
        файла что бы подготовить (stage) изменения к фиксации. Затем правый
        щелчёк на отладочной линии и выберите <em>Unstage Line From Commit
        </em>.</p>

        <p><img src="images/11.png" /></p>

        <p>Теперь отладочная линия не была подготовлена (unstaged) к фиксации,
        в то время как остальные изменения были. Осталось только заполнить
        сообщение фиксации и зафиксировать изменения щёлкнув по <em>Commit
        </em>.</p>

        <p><img src="images/12.png" /></p>

        <h2 id="branching">Ветвление (branching)</h2>

        <p>Теперь, давайте предположим что мы хотим начать добавлять новые
        возможности в нашу следующую большую версию программы. Но мы так же
        хотим сохранить стабильную версию в которой исправлять ошибки. Что бы
        сделать это мы создадим ветку (branch) для наших новый разработок. Что
        бы создать новую ветку в git gui выберете <i>Branch &rarr; Create</i>.
        Большая возможность какую я хочу добавить это возможность спросить
        пользователя его фамилию, поэтому я назову ветку <span class="tt">
        lastname</span>. Опции по умолчанию подходят без изменений, так что
        просто введите имя и щёлкните <em>Create</em>.</p>

        <p><img src="images/14.png" /></p>

        <p>Теперь когда я в <span class="tt">lastname</span> ветке, я могу
        делать мои новые модификации:</p>

        <pre>
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

int main(int argc, char **argv)
{
    char first[255], last[255];

    printf("Enter your first name: ");
    fgets(first, 255, stdin);
    first[strlen(first)-1] = '\0'; /* remove the newline at the end */

    printf("Now enter your last name: ");
    gets(last); /* buffer overflow? what's that? */

    printf("Hello %s %s!\n", first, last);
    return 0;
}
</pre>

        <p>Теперь я могу зафиксировать изменения. Заметте что я фиксирую
        изменения используя другое имя. Мы рассмотрим это позже. Обычно вы
        всегда будете использовать одно и тоже имя для фиксаций.</p>

        <p><img src="images/15.png" /></p>

        <p>Между тем, пользователь проинформировал нас что не показ запятой
        после прямого обращения к кому-то это серьёзная ошибка. Что бы
        исправить её в нашей стабильной ветке, вы сначала должны переключится
        назад на неё. Это достигается используя <i>Branch &rarr; Checkout</i>.

        <p><img src="images/16.png" /></p>

        <p>Теперь мы можем исправить нашу большую ошибку.</p>

        <p><img src="images/17.png" /></p>

        <p>Если мы выберем <i>Repository &rarr; Visualize All Branch
            History</i>, мы увидим как складывается наша история.</p>

        <p><img src="images/18.png" /></p>

        <h2 id="merging">Слияние (merging)</h2>

        <p>После напряжённой работы мы решили что наша <span class="tt">lastname
        </span> ветка достаточно стабильна что бы влить её в <span class="tt">
        master</span> ветку. Что бы выполнить слияние, используйте <i>Merge
        &rarr; Local Merge</i>.</p>

        <p><img src="images/19.png" /></p>

        <p>Так как две разных фиксации делали два разных изменения на одной и
        той же линии, происходит конфликт (conflict).</p>

        <p><img src="images/20.png" /></p>
        <p><img src="images/21.png" /></p>

        <p>Конфликт может быть разрешён используя любой текстовый редактор.
        После разрешения конфликта, подготовьте изменения шёлкнув на иконке
        файла и зафиксируйте слияние щёлкнув по <em>Commit</em> кнопке.</p>

        <p><img src="images/22.png" /></p>

        <h2 id="history">Просмотр истории</h2>

        <p>Файл <span class="tt">main.c</span> становится немного большим,
        поэтому я решил вынести код, спрашивающий имя пользователя в отдельную
        функцию. Пока я это делал, я решил вынести функцию в отдельный файл.
        Хранилище теперь содержит файлы <span class="tt">main.c</span>, <span
        class="tt"> askname.c</span>, и <span class="tt">askname.h</span>.</p>

        <pre>
/* main.c */
#include &lt;stdio.h&gt;

#include "askname.h"

int main(int argc, char **argv)
{
    char first[255], last[255];

    askname(first, last);

    printf("Hello, %s %s!\n", first, last);
    return 0;
}
</pre>

        <pre>
/* askname.c */
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

void askname(char *first, char *last)
{
    printf("Enter your first name: ");
    fgets(first, 255, stdin);
    first[strlen(first)-1] = '\0'; /* remove the newline at the end */

    printf("Now enter your last name: ");
    gets(last); /* buffer overflow? what's that? */
}
</pre>

        <pre>
/* askname.h */
void askname(char *first, char *last);
</pre>

        <p><img src="images/23.png" /></p>

        <p>История хранилища может быть просмотрена и изучена выбрав <i>
        Repository &rarr; Visualize All Branch History</i>. На следующем
        скриншоте я пытаюсь найти в какой фиксации была добавлена <span
        class="tt">last</span> переменная, ищя все фиксации в которых было
        добавлено или убрано слово <em>last</em>. Фиксации, которые подходят
        под условия поиска отмечены жирным шрифтом, что бы быстро и легко
        обнаружить нужную фиксацию.</p>

        <p><img src="images/27.png" /></p>

        <p>Через пару дней, кто-то просматривая наш код увидел что <span
        class="tt">gets</span> функция может вызвать переполнение буффера.
        Будучи любителем показывать пальцем, этот человек решает запустить git
        blame что бы увидеть кто последний раз редактировал эту линию кода.
        Проблема в том что Боб, тот кто зафиксировал эту линию в хранилище, а
        я последний кто трогал её когда я переместил строку в другой файл.
        Очевидно, я не виноват (конечно же). Но так ли умён git что бы
        обнаружить это? Да, это так.</p>

        <p>Что бы запустить blame, выберете <i>Repository &rarr; Browse
        master's Files</i>. Из дерева которое появится дважды щёлкните на файле
        с интересующей строкой, который в данном случае <span class="tt">
        askname.c</span>. Наведённая мышка на интересующую линию показывает нам
        подсказку, которая говорит нам всё что нам надо знать.</p>

        <p><img src="images/24.png" /></p>

        <p>Здесь мы можем видить что эта линия была зафиксирована Бобом в
        фиксации <span class="tt">f6c0</span>, а затем я её переместил в её
        новое месторасположение в фиксации <span class="tt">b312</span>.

        <h2 id="pushing">Заталкивание на удалённый сервер</h2>

        <p>Before pushing to a remote server, you must first create a
        SSH public and private key pair. By using SSH, you will be able
        to securely authenticate to the server that you are who you say
        you are. Creating the key pair is a simple process. Begin by
        running the <span class="tt">puttygen.exe</span> program
        downloaded earlier.  Next, click the <em>Generate</em> button to
        generate the keys.  After processing for a few seconds, click
        the <em>Save private key</em> button to save your new private
        key. Copy the public key to the clipboard in preparation for the
        next step. I would recommend not clicking the <em>Save public
            key</em> button because the saved file is in a non-standard
        format; trying to use it with other software might be
        problematic.</p>

        <p><img src="images/32.png" /></p>

        <p>Now that the keys are generated, the remote servers need to
        know about it. If you would like to use <a
            href="http://github.com/">github</a> to host your code, just
        go to your account page and paste in the public key.</p>

        <p><img src="images/33.png" /></p>

        <p>Now github has our public key, but we do not yet have
        github's. To remedy this, launch <span
            class="tt">putty.exe</span>, connect to <span
            class="tt">github.com</span>, and click <em>Yes</em> to
        accept github's public key. You can safely close the login
        window that opens up after accepting the key.

        <p><img src="images/34.png" /></p>

        <p><img src="images/35.png" /></p>

        <p>We need our private key to be loaded up to use with our
        public key, so launch <span class="tt">pageant.exe</span>. This
        program will create an icon in your system tray. Double clicking
        on the icon will open up a window into which the private key can
        be added. Once the private key is added, the agent will sit in
        the background and provide authentication when needed.</p>

        <p><img src="images/36.png" /></p>

        <p>Now that our client and server can authenticate each other,
        it is time to push! <i>Remote &rarr; Push</i> will open up
        the push dialog. Typing in the commit address for the project
        and clicking <em>Push</em> will send the changes on their way.</p>

        <p><img src="images/37.png" /></p>

        <p><img src="images/38.png" /></p>

        <p>Of course, typing in the remote url would become quite
        annoying if we had to do it with every push. Instead, git allows
        us to alias the long urls using remotes. Git gui currently does
        not have a way to add a remote, so the command line must be
        used. Right click on the repository folder and choose <i>Git Bash Here</i>.
        In the prompt, enter the following command:</p>

        <pre>
git remote add github git@github.com:nathanj/example.git
</pre>

        <p>Note: After adding a remote, close and reopen git gui for it to recognize
        the new remote.</p>

        <p>Now the remote <span class="tt">github</span> is aliased to
        the url <span
            class="tt">git@github.com:nathanj/example.git</span>. When
        viewing the push dialog in git gui, a convenient drop down list
        of remotes is shown.</p>

        <p><img src="images/39.png" /></p>

        <h2 id="pulling">Вытягивание с удалённого сервера</h2>

        <p>Because our code is so useful, dozens of people have
        downloaded and now use our program. One person in particular,
        Fred, has decided to fork our project and add his own commits.
        Now that he's added his code, he would like us to pull those
        commits from him into our repository. To do this, first create
        another remote.</p>

        <pre>
git remote add fred ssh://fred@192.168.2.67/home/fred/example
</pre>

        <p>Now we can fetch Fred's changes using <i>Remote &rarr; Fetch
            from &rarr; fred</i>.

        <p><img src="images/40.png" /></p>

        <p>After the fetch, Fred's commits have now been added to our
        local repository under the <span
            class="tt">remotes/fred/master</span> branch. We can use
        gitk to visualize the changes that Fred has made.</p>

        <p><img src="images/41.png" /></p>

        <p>If we like all of Fred's changes, we could do a normal merge
        as before. In this case though, I like one of his commits but
        not the other. To only merge one of his commits, right click on
        the commit and choose <i>Cherry-pick this commit</i>. The
        commit will then be merged into the current branch.</p>

        <p><img src="images/42.png" /></p>
        <p><img src="images/43.png" /></p>

        <p>We can now push a final time to send Fred's patch to our
        github tree for everyone to see and use.</p>

        <p><img src="images/45.png" /></p>

        <h2 id="conclusion">Заключение</h2>

        <p>In this guide, I have shown how to do many common tasks in
        git using GUI tools. I hope that this guide has shown that it is
        not only possible but easy to use git on Windows without having
        to use the Windows shell for most operations.</p>

        <p>If you have any comments about this guide, feel free to <a
            href="mailto:nathanj@insightbb.com">contact me</a>.</p>

    </body>
</html>

